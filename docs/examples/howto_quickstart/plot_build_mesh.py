"""
A mesh can be build from an array of points and cells.
======================================================

"""

# %%
import numpy as np

import ogstools.meshlib as ml

# %%
# A simple mesh of one tetrahedral cell.
cells = np.array([[0, 1, 2, 3]])

points = np.array(
    [[1.0, 1.0, 1.0], [1.0, -1.0, -1.0], [-1.0, 1.0, -1.0], [-1.0, -1.0, 1.0]]
)

mesh = ml._mesh_from_points_cells(points, cells)
mesh.plot(show_edges=True)

# %%
# A cubic mesh with 2x2x2 cells.
points = np.array(
    [
        [0.0, 0.0, 0.0],
        [1.0, 0.0, 0.0],
        [0.5, 0.0, 0.0],
        [1.0, 1.0, 0.0],
        [1.0, 0.5, 0.0],
        [0.0, 1.0, 0.0],
        [0.5, 1.0, 0.0],
        [0.0, 0.5, 0.0],
        [0.5, 0.5, 0.0],
        [1.0, 0.0, 0.5],
        [1.0, 0.0, 1.0],
        [0.0, 0.0, 0.5],
        [0.0, 0.0, 1.0],
        [0.5, 0.0, 0.5],
        [0.5, 0.0, 1.0],
        [1.0, 1.0, 0.5],
        [1.0, 1.0, 1.0],
        [1.0, 0.5, 0.5],
        [1.0, 0.5, 1.0],
        [0.0, 1.0, 0.5],
        [0.0, 1.0, 1.0],
        [0.5, 1.0, 0.5],
        [0.5, 1.0, 1.0],
        [0.0, 0.5, 0.5],
        [0.0, 0.5, 1.0],
        [0.5, 0.5, 0.5],
        [0.5, 0.5, 1.0],
    ],
)

cells = np.array(
    [
        [0, 2, 8, 7, 11, 13, 25, 23],
        [2, 1, 4, 8, 13, 9, 17, 25],
        [7, 8, 6, 5, 23, 25, 21, 19],
        [8, 4, 3, 6, 25, 17, 15, 21],
        [11, 13, 25, 23, 12, 14, 26, 24],
        [13, 9, 17, 25, 14, 10, 18, 26],
        [23, 25, 21, 19, 24, 26, 22, 20],
        [25, 17, 15, 21, 26, 18, 16, 22],
    ],
)

ml.Mesh.from_points_cells(points, cells).plot(show_edges=True)
# %%
